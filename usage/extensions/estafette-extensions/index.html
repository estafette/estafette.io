<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-464018-9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-464018-9');</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href="/apple-touch-icon.png?v=xQdjvJ8Lmw"><link rel=icon type=image/png sizes=32x32 href="/favicon-32x32.png?v=xQdjvJ8Lmw"><link rel=icon type=image/png sizes=16x16 href="/favicon-16x16.png?v=xQdjvJ8Lmw"><link rel=manifest href="/site.webmanifest?v=xQdjvJ8Lmw"><link rel=mask-icon href="/safari-pinned-tab.svg?v=xQdjvJ8Lmw" color=#28a745><link rel="shortcut icon" href="/favicon.ico?v=xQdjvJ8Lmw"><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><title>Estafette extensions &ndash; Estafette CI/CD</title><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link rel=stylesheet href=https://estafette.io/sass/estafette.min.d7c77d1201ccb0a9ee9a9d4ea139fcad246f59d4ba4b07a4f7dd4c0f7c744c97.css integrity="sha256-18d9EgHMsKnump1OoTn8rSRvWdS6Swek991MD3x0TJc="></head><body><div id=header-and-main><nav class="navbar navbar-dark bg-dark navbar-expand-md"><a href=/ class="navbar-brand text-white mr-3 router-link-exact-active active" target=_self><svg style="width:1.25em;overflow:visible;vertical-align:-2.5px" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="shipping-fast" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="m-0 ml-2 mr-2 h5 svg-inline--fa fa-shipping-fast fa-w-20"><path fill="currentcolor" d="M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H112C85.5.0 64 21.5 64 48v48H8c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h272c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H40c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H8c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H64v128c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8.0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5.0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm320 0c-26.5.0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"/></svg><em class=align-top>Estafette</em></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class=navbar-nav><a class="nav-item nav-link" href=/getting-started/>Getting started</a><a class="nav-item nav-link active" href=/usage/>Usage</a><a class="nav-item nav-link" href=/security/>Security</a><a class="nav-item nav-link" href=/design/>Design</a><a class="nav-item nav-link" href=/screenshots/>Screenshots</a></div></div></nav><div id=main><div class=container-fluid><div class="row mt-4 mb-4"><div class="col d-none d-md-flex border-right sidebar sticky-top"><ul><li class=section-item><a href=/getting-started/ class=section-item-link>Getting started</a></li><li class=section-item><a href=/usage/ class="section-item-link ancestor">Usage</a><ul><li class=page-item><a href=/usage/manifest/ class=page-item-link>Manifest</a></li><li class=section-item><a href=/usage/extensions/ class="section-item-link ancestor">Extensions</a><ul><li class=page-item><a href=/usage/extensions/estafette-extensions/ class="page-item-link active">Estafette extensions</a></li><li class=page-item><a href=/usage/extensions/build-an-extension/ class=page-item-link>Build an extension</a></li></ul></li><li class=page-item><a href=/usage/best-practices/ class=page-item-link>Best practices</a></li><li class=page-item><a href=/usage/examples/ class=page-item-link>Examples</a></li></ul></li><li class=section-item><a href=/security/ class=section-item-link>Security</a></li><li class=section-item><a href=/design/ class=section-item-link>Design</a></li><li class=section-item><a href=/screenshots/ class=section-item-link>Screenshots</a></li></ul></div><div class="col pl-5 pr-5 pt-4 content-block"><h1 class=mb-4>Estafette extensions</h1><h3 id=extensionsgit-clone>extensions/git-clone</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>git-clone:
  image: extensions/git-clone:stable
  shallow: &lt; boolean | <span style=color:#00f>true</span> &gt;
</code></pre></div><p>The <code>git-clone</code> stage is automatically injected if not present in your manifest for the build stages; in the release stages it's not injected. In case you don't need anything from your repository to release this speeds things up.</p><p>The shallow clone - enabled by default - checks out the latest 50 commits for the particular branch, then selects the correct revision. When rebuilding an older version or releasing an older version this might not be enough, in that case explicitly set <code>shallow: false</code>.</p><h5 id=cloning-another-repository-from-the-same-owner>cloning another repository from the same owner</h5><p>You can use the <code>git-clone</code> extension to clone another repository as well, as long as it's from the same owner. In order to make use of it you need to specify the repository name (without owner), and optionally the branch you want to clone (defaults to master) and the subdir to clone it into (defaults to the repository name).</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>clone-another-repo:
  image: extensions/git-clone:stable
  shallow: &lt; boolean | <span style=color:#00f>true</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>repo: &lt; string &gt;</span>
  branch: &lt; string | master <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>subdir: &lt; string | repo &gt;</span>
</code></pre></div><p>Notes:</p><ul><li>Make sure to avoid the stage name <code>git-clone</code> if you're cloning another repository in one of your stages, because the regular repository will not be cloned automatically in that case.</li></ul><h3 id=extensionsdocker>extensions/docker</h3><p>The <code>docker</code> extension supports the following actions: <em>build</em>, <em>push</em>, <em>tag</em>. For pushing and tagging containers it uses the <em><a href=/getting-started/configuration/#credentials>credentials and trusted images</a></em> configuration in the Estafette server to get access to Docker registry credentials automatically.</p><h5 id=build>build</h5><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>bake:
  image: extensions/docker:stable
  action: build
  no-cache: &lt; bool | <span style=color:#00f>false</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>expand-variables: &lt; bool | true &gt;</span>
  container: &lt; string | ESTAFETTE_GIT_NAME <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>repositories:</span>
  - estafette
  path: &lt; string | . <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>dockerfile: &lt; string | Dockerfile &gt;</span>
  copy:
  - &lt; string | copies Dockerfile by default <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>- /etc/ssl/certs/ca-certificates.crt</span>
</code></pre></div><p>The <code>no-cache</code> options ensures that no previous container built for your branch gets used, but it absolutely uses the latest version of the image in your FROM statement.</p><p>The <code>expand-variables</code> option allows you to turn off variable expansion, in case you use <code>$PATH</code> or another frequently set variable in your Dockerfile.</p><p>A minimal version when using all defaults looks like:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>bake:
  image: extensions/docker:stable
  action: build
  repositories:
  - estafette
</code></pre></div><p>If you'd like to avoid having a separate Dockerfile you can inline it as well.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>  bake:
    image: extensions/docker:stable
    action: build
    inline: <span style=color:#5a2>|
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>FROM scratch</span>
      COPY ca-certificates.crt /etc/ssl/certs/
      COPY ${ESTAFETTE_GIT_NAME} /
      ENTRYPOINT [<span style=color:#5a2>&#34;/${ESTAFETTE_GIT_NAME}&#34;</span>]
    repositories:
    - estafette
    path: ./publish
    copy:
    - /etc/ssl/certs/ca-certificates.crt
</code></pre></div><h5 id=push>push</h5><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>push:
  image: extensions/docker:stable
  action: push
  container: &lt; string | ESTAFETTE_GIT_NAME <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>repositories:</span>
  - estafette
  tags:
  - &lt; string | tags with ESTAFETTE_BUILD_VERSION by default and is always pushed <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>- dev</span>
</code></pre></div><p>A minimal version when using all defaults looks like:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>push:
  image: extensions/docker:stable
  action: push
  repositories:
  - estafette
</code></pre></div><h5 id=tag>tag</h5><p>To later on tag a specific version with another tag - for example to promote a dev version to stable you can use the <code>docker</code> extension to tag that version with other tags:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>tag:
  image: extensions/docker:dev
  action: tag
  container: &lt; string | ESTAFETTE_GIT_NAME <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>repositories:</span>
  - estafette
  tags:
  - stable
  - latest
</code></pre></div><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>tag:
  image: extensions/docker:stable
  action: tag
  repositories:
  - estafette
  tags:
  - latest
</code></pre></div><h3 id=extensionsgke>extensions/gke</h3><p>The <code>gke</code> extension is used to deploy an application to Kubernetes Engine. It generates a very opinionated deployment with a sidecar. It asumes <em>horizontal pod autoscaling</em>, it injects secrets and configs in a standard way, and uses a lot of other sensible defaults to be able to use it with a minimum number of parameters specified.</p><p>By default it includes an <a href=https://openresty.org/en/>OpenResty</a> sidecar handling incoming traffic and forwarding requests. (<a href=https://github.com/estafette/openresty-sidecar>This</a> is the custom openresty image injected by default.) The sidecar configuration can be adjusted, and additional sidecars can be included by customizing the <code>sidecars</code> field. (The only other type currently supported is the <code>cloudsqlproxy</code>, which adds the proxy implementing secure communication with Google Cloud SQL databases.)<br>If you don't want to use the default sidecar, you should add the <code>injecthttpproxysidecar: false</code> field to the deployment, then it will not be injected during the development.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>deploy:
  image: extensions/gke:stable
  credentials: &lt; string | gke-ESTAFETTE_RELEASE_NAME <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>app: &lt; string | ESTAFETTE_GIT_NAME &gt;</span>
  namespace: &lt; string | default namespace from credentials config <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>visibility: &lt; string | private &gt;</span>
  container:
    repository: &lt; string <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>name: &lt; string | app &gt;</span>
    tag: &lt; string | ESTAFETTE_BUILD_VERSION <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>port: &lt; integer | 5000 &gt;</span>
    env:
      MY_CUSTOM_ENV: value1
      MY_OTHER_CUSTOM_ENV: value2
    cpu:
      request: &lt; string | 100m <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>limit: &lt; string | 125m &gt;</span>
    memory:
      request: &lt; string | 128Mi <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>limit: &lt; string | 128Mi &gt;</span>
    liveness:
      path: &lt; string | /liveness <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>delay: &lt; integer | 30 &gt;</span>
      timeout: &lt; integer | <span style=color:#3af>1</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>readiness:</span>
      path: &lt; string | /readiness <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>delay: &lt; integer | 0 &gt;</span>
      timeout: &lt; integer | <span style=color:#3af>1</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>metrics:</span>
      scrape: &lt; boolean | <span style=color:#00f>true</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>path: &lt; string | /metrics &gt;</span>
      port: &lt; integer | .container.port <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>sidecars:</span>
  - type: &lt; string | openresty | cloudsqlproxy <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>image: &lt; string | estafette/openresty-sidecar:1.13.6.2-alpine | gcr.io/cloudsql-docker/gce-proxy:1.13 &gt;</span>
    env:
      CORS_ALLOWED_ORIGINS: <span style=color:#5a2>&#34;*&#34;</span>
      CORS_MAX_AGE: <span style=color:#5a2>&#34;86400&#34;</span>
    cpu:
      request: &lt; string | 10m <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>limit: &lt; string | 50m &gt;</span>
    memory:
      request: &lt; string | 10Mi <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>limit: &lt; string | 50Mi &gt;</span>
    <span style=color:#888;font-style:italic># Only relevant for cloudsqlproxy</span>
    dbinstanceconnectionname: my-gcloud-project:europe-west1:my-database
    sqlproxyport: <span style=color:#3af>5043</span>
  <span style=color:#888;font-style:italic># Additional sidecars can be listed here.</span>
  - type: &lt; string | openresty | cloudsqlproxy <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>image: &lt; string | estafette/openresty-sidecar:1.13.6.2-alpine | gcr.io/cloudsql-docker/gce-proxy:1.13 &gt;</span>
    ...
  replicas: &lt; integer | <span style=color:#3af>0</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>autoscale:</span>
    enabled: &lt; bool | <span style=color:#00f>true</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>min: &lt; integer | 3 &gt;</span>
    max: &lt; integer | <span style=color:#3af>100</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>cpu: &lt; integer | 80 &gt;</span>
    safety:
      enabled: &lt; bool | <span style=color:#00f>false</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>promquery: &lt; string | sum(rate(nginx_http_requests_total{app=&#39;app&#39;}[5m])) by (app) &gt;</span>
      ratio: &lt; float | <span style=color:#3af>1.0</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>delta: &lt; float | 0.0 &gt;</span>
      scaledownratio: &lt; float | <span style=color:#3af>1.0</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>secrets:</span>
    keys:
      secret-file<span style=color:#3af>-1.</span>json: c29tZSBzZWNyZXQgdmFsdWU=
      secret-file<span style=color:#3af>-2.</span>yaml: YW5vdGhlciBzZWNyZXQgdmFsdWU=
    mountpath: /secrets
  configs:
    <span style=color:#888;font-style:italic># these are local files with golang template style placeholders, replaced with the values specified in the data section;</span>
    <span style=color:#888;font-style:italic># set clone: true on the release target to ensure you have access to these files stored in your repository</span>
    files:
    - config/config.json
    - config/anotherconfig.yaml
    <span style=color:#888;font-style:italic># these are the values for the placeholders specified as {{.property1}} to be replaced in the config files</span>
    data:
      property1: value <span style=color:#3af>1</span>
      property2: value <span style=color:#3af>2</span>
    <span style=color:#888;font-style:italic># if you want to avoid cloning your repository and just need to pass a very short config you can inline full files here</span>
    inline:
      inline-config.properties: <span style=color:#5a2>|
</span><span style=color:#5a2>       </span><span style=color:#5a2> </span><span style=color:#5a2>enemies=aliens</span>
        lives=<span style=color:#3af>3</span>
    mountpath: /configs
  manifests:
    files:
    - override/service.yaml
    data:
      property3: value <span style=color:#3af>3</span>
  hosts:
  - gke.estafette.io
  - gke-deploy.estafette.io
  basepath: &lt; string | / <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>enablePayloadLogging: &lt; boolean | false &gt;</span>
  chaosproof: &lt; boolean | <span style=color:#00f>false</span> <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>rollingupdate:</span>
    maxsurge: &lt; string | <span style=color:#3af>25</span>% <span style=color:#5a2>&gt;
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>maxunavailable: &lt; string | 25% &gt;</span>
    timeout: &lt; string | 5m <span style=color:#5a2>&gt;
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>trustedips:</span>
  - <span style=color:#3af>103.21</span><span style=color:#3af>.244</span><span style=color:#3af>.0</span>/<span style=color:#3af>22</span>
  - <span style=color:#3af>103.22</span><span style=color:#3af>.200</span><span style=color:#3af>.0</span>/<span style=color:#3af>22</span>
  - <span style=color:#3af>103.31</span><span style=color:#3af>.4</span><span style=color:#3af>.0</span>/<span style=color:#3af>22</span>
  dryrun: &lt; boolean | <span style=color:#00f>false</span> &gt;
</code></pre></div><p>A very minimal version when using all the defaults looks like:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>production:
  stages:
    deploy:
      image: extensions/gke:stable
      visibility: private
      container:
        repository: estafette
      hosts:
      - ci.estafette.io
</code></pre></div><p>Default visibility is set to private, which creates an internal ingress and it makes the service accessible from within same network. Other supported visibilities are <code>public-whitelist</code>, <code>iap</code>, <code>apigee</code> and <code>esp</code>.</p><p>For visibility <code>esp</code>, <code>useGoogleCloudCredentials</code> and <code>disableServiceAccountKeyRotation</code> should be set to <code>true</code>, <code>espOpenapiYamlPath</code> must be set and exactly one <code>host</code> must be provided.
e.g.:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>production:
  stages:
    deploy:
      image: extensions/gke:stable
      visibility: esp
      useGoogleCloudCredentials: <span style=color:#00f>true</span>
      disableServiceAccountKeyRotation: <span style=color:#00f>true</span>
      espOpenapiYamlPath: openapi.dev.yaml
</code></pre></div><p>For visibility <code>iap</code>, base64 encoded values of <code>iapOauthClientID</code> and <code>iapOauthClientSecret</code> must be provided.
e.g.:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>production:
  stages:
    deploy:
      image: extensions/gke:stable
      visibility: iap
      iapOauthClientID: aSBhbSBzb21lIGNsaWVudAo= <span style=color:#888;font-style:italic># base64 encoded client ID</span>
      iapOauthClientSecret: estafette.secret(...) <span style=color:#888;font-style:italic># base64 encoded client secret</span>
</code></pre></div><p>For visibility <code>apigee</code>, <code>authsecret</code> under <code>request</code> must refer to a Secret containing certificate for client authentication.
e.g.:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>production:
  stages:
    deploy:
      image: extensions/gke:stable
      visibility: apigee
      request:
        authsecret: nginx-open/org-ca-cert
</code></pre></div><h3 id=extensionsgithub-status>extensions/github-status</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>set-build-status:
  image: extensions/github-status:stable
  status: &lt; string | ESTAFETTE_BUILD_STATUS &gt;
</code></pre></div><p>The <code>github-status</code> extension takes the build status from the <code>ESTAFETTE_BUILD_STATUS</code> environment variable, but this can be overridden with the <code>status</code> tag. Depending on the source of the git push - github or bitbucket - this extension is automatically injected at the beginning of the build stages and at the end in order to set the build status in the respective source code hosting system:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>set-pending-build-status:
  image: extensions/github-status:stable
  status: pending

...

set-build-status:
  image: extensions/github-status:stable
  when:
    status == <span style=color:#5a2>&#39;succeeded&#39;</span> |<span style=color:#5a2>| 
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>status == &#39;failed&#39;</span>
</code></pre></div><h3 id=extensionsbitbucket-status>extensions/bitbucket-status</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>set-build-status:
  image: extensions/bitbucket-status:stable
  status: &lt; string | ESTAFETTE_BUILD_STATUS &gt;
</code></pre></div><p>The <code>bitbucket-status</code> extension takes the build status from the <code>ESTAFETTE_BUILD_STATUS</code> environment variable, but this can be overridden with the <code>status</code> tag. Depending on the source of the git push - github or bitbucket - this extension is automatically injected at the beginning of the build stages and at the end in order to set the build status in the respective source code hosting system:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>set-pending-build-status:
  image: extensions/bitbucket-status:stable
  status: pending

...

set-build-status:
  image: extensions/bitbucket-status:stable
  when:
    status == <span style=color:#5a2>&#39;succeeded&#39;</span> |<span style=color:#5a2>| 
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>status == &#39;failed&#39;</span>
</code></pre></div><h3 id=extensionsslack-build-status>extensions/slack-build-status</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>slack-notify:
  image: extensions/slack-build-status:stable
  workspace: estafette
  channels:
  - <span style=color:#5a2>&#39;#mychannel&#39;</span>
  when:
    status == <span style=color:#5a2>&#39;succeeded&#39;</span> |<span style=color:#5a2>| 
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>status == &#39;failed&#39;</span>
</code></pre></div><p>In order to send build notifications to one or more Slack channels the <code>slack-build-status</code> extension automatically sends a messages depending on the build status into the <code>channels</code> passed to this extension for the <code>workspace</code> you've set.</p><p>Notes:</p><ul><li>This extension uses the <em><a href=/getting-started/configuration/#credentials>credentials and trusted images</a></em> configuration in the Estafette server to gain access to the slack webhooks configured there.</li><li>To provide a custom title, you can use <code>title</code> optional input. This will override the title usually composed by the extension.</li></ul><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>slack-notify:
  image: extensions/slack-build-status:stable
  workspace: estafette
  channels:
  - <span style=color:#5a2>&#39;#mychannel&#39;</span>
  title: Releasing!
  when:
    status == <span style=color:#5a2>&#39;succeeded&#39;</span> |<span style=color:#5a2>| 
</span><span style=color:#5a2>   </span><span style=color:#5a2> </span><span style=color:#5a2>status == &#39;failed&#39;</span>
</code></pre></div><ul><li>If you only want to send a message on failure use</li></ul><pre><code>  when:
    status == 'failed'
</code></pre><h3 id=extensionsnpm-audit>extensions/npm-audit</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>stages:
  audit:
    image: extensions/npm-audit:stable
    action: audit
    level: low
    dev-level: none
    workspace: estafette
    channels:
    - <span style=color:#5a2>&#39;#builds-${ESTAFETTE_LABEL_TEAM}&#39;</span>
</code></pre></div><h4 id=audit>audit</h4><p>For now the only supported action is <code>audit</code></p><h5 id=level>level</h5><p>This is the level you set to check for the vulnerabilities in the <code>dependencies</code> from your <code>package.json</code>.</p><p>Possible values are:</p><ul><li><code>none</code></li><li><code>low</code></li><li><code>moderate</code></li><li><code>high</code></li><li><code>critical</code></li></ul><p>With level <code>none</code> you disable the check completely.</p><h5 id=example>example</h5><p>Let's say you want to check only for vulnerabilities that have a priority level higher or equal to <strong>moderate</strong>.</p><p>Then if audit finds vulnerabilities with level lower than moderate, this extension will send a Slack message to <a href=#channels>channels</a> with the npm audit report. And your build will continue.</p><p>If audit finds vulnerabilities with level higher or equal to moderate, then your build will break and you will still receive a Slack message.</p><p>If audit doesn't find any vulnerabilities, then you get no Slack message and your build will continue.</p><h5 id=dev-level>dev-level</h5><p>This is the same as <a href=#level>Level</a>. But for the <code>devDependencies</code> from your <code>package.json</code></p><h5 id=workspace>workspace</h5><p>The Slack workspace you use.</p><h5 id=channels>channels</h5><p>A list with the Slack channels you want to send the reports with the result from npm audit.</p></div><div class="col d-none d-xl-flex border-left toc sticky-top"><ul><li class=section-item><a class="section-item-link ancestor">Table of contents</a><ul><li class=page-item><a href=/usage/extensions/estafette-extensions/#extensionsgit-clone title=extensions/git-clone class=page-item-link>extensions/git-clone</a><ul><li class=page-item><a href=/usage/extensions/estafette-extensions/#cloning-another-repository-from-the-same-owner title="cloning another repository from the same owner" class=page-item-link>cloning another repository from the same owner</a></ul><li class=page-item><a href=/usage/extensions/estafette-extensions/#extensionsdocker title=extensions/docker class=page-item-link>extensions/docker</a><ul><li class=page-item><a href=/usage/extensions/estafette-extensions/#build title=build class=page-item-link>build</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#push title=push class=page-item-link>push</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#tag title=tag class=page-item-link>tag</a></ul><li class=page-item><a href=/usage/extensions/estafette-extensions/#extensionsgke title=extensions/gke class=page-item-link>extensions/gke</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#extensionsgithub-status title=extensions/github-status class=page-item-link>extensions/github-status</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#extensionsbitbucket-status title=extensions/bitbucket-status class=page-item-link>extensions/bitbucket-status</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#extensionsslack-build-status title=extensions/slack-build-status class=page-item-link>extensions/slack-build-status</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#extensionsnpm-audit title=extensions/npm-audit class=page-item-link>extensions/npm-audit</a><ul><li class=page-item><a href=/usage/extensions/estafette-extensions/#audit title=audit class=page-item-link>audit</a><ul><li class=page-item><a href=/usage/extensions/estafette-extensions/#level title=level class=page-item-link>level</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#example title=example class=page-item-link>example</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#dev-level title=dev-level class=page-item-link>dev-level</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#workspace title=workspace class=page-item-link>workspace</a><li class=page-item><a href=/usage/extensions/estafette-extensions/#channels title=channels class=page-item-link>channels</a></ul></li></ul></div></div></div></div></div><nav class="footer nav justify-content-end bg-dark p-2"><a href=https://github.com/estafette/estafette-ci-central target=_blank class="nav-link text-light">Github</a></nav><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script></body></html>