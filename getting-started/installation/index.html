<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-464018-9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-464018-9');</script><meta charset=utf-8><title>Installation &ndash; Estafette CI/CD</title><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link rel=stylesheet href=https://estafette.io/sass/estafette.min.daa8667c18dee5e14fbeec902662f83d41f9ce67e357f6a246d8e42655fab315.css integrity="sha256-2qhmfBje5eFPvuyQJmL4PUH5zmfjV/aiRtjkJlX6sxU="></head><body><div id=header-and-main><nav class="navbar navbar-dark bg-dark navbar-expand-md"><a href=/pipelines class="navbar-brand text-white mr-3 router-link-exact-active active" target=_self><svg style="width:1.25em;overflow:visible;vertical-align:-2.5px" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="shipping-fast" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="m-0 ml-2 mr-2 h5 svg-inline--fa fa-shipping-fast fa-w-20"><path fill="currentcolor" d="M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H112C85.5.0 64 21.5 64 48v48H8c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h272c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H40c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H8c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H64v128c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8.0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5.0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm320 0c-26.5.0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"/></svg><em class=align-top>Estafette</em></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class=navbar-nav><a class="nav-item nav-link active" href=/getting-started/>Getting started</a><a class="nav-item nav-link" href=/usage/>Usage</a><a class="nav-item nav-link" href=/design/>Design</a><a class="nav-item nav-link" href=/screenshots/>Screenshots</a></div></div></nav><div id=main><div class=container-fluid><div class="row mt-4 mb-4"><div class="col d-none d-md-flex border-right sidebar sticky-top"><ul><li class=section-item><a href=/getting-started/ class="section-item-link ancestor">Getting started</a><ul><li class=page-item><a href=/getting-started/installation/ class="page-item-link active">Installation</a></li><li class=page-item><a href=/getting-started/configuration/ class=page-item-link>Configuration</a></li></ul></li><li class=section-item><a href=/usage/ class=section-item-link>Usage</a></li><li class=section-item><a href=/design/ class=section-item-link>Design</a></li><li class=section-item><a href=/screenshots/ class=section-item-link>Screenshots</a></li></ul></div><div class="col pl-5 pr-5 pt-4 content-block"><h1 class=mb-4>Installation</h1><h3 id=installing-estafette-ci>Installing Estafette CI</h3><p>Prerequisites:</p><ul><li>install <a href=https://github.com/estafette/estafette-cloudflare-dns>https://github.com/estafette/estafette-cloudflare-dns</a></li><li>install <a href=https://github.com/estafette/estafette-letsencrypt-certificate>https://github.com/estafette/estafette-letsencrypt-certificate</a></li><li>install <a href=https://github.com/estafette/k8s-cockroachdb>https://github.com/estafette/k8s-cockroachdb</a></li></ul><p>Configure cluster roles and binding:</p><pre><code>curl https://raw.githubusercontent.com/estafette/estafette-ci-api/master/rbac.yaml -o rbac.yaml

export NAMESPACE=estafette
export APP_NAME=estafette-ci-api

kubectl apply -f rbac.yaml
</code></pre><p>Install the API:</p><pre><code>curl https://raw.githubusercontent.com/estafette/estafette-ci-api/master/kubernetes.yaml -o kubernetes.yaml

export NAMESPACE=estafette
export APP_NAME=estafette-ci-api
export TEAM_NAME=tooling-team
export HOSTNAMES=ci.estafette.io
export CLOUDFLARE_IP_RANGES=103.21.244.0/22, 103.22.200.0/22, 103.31.4.0/22, 104.16.0.0/12, 108.162.192.0/18, 131.0.72.0/22, 141.101.64.0/18, 162.158.0.0/15, 172.64.0.0/13, 173.245.48.0/20, 188.114.96.0/20, 190.93.240.0/20, 197.234.240.0/22, 198.41.128.0/17
export GITHUB_APP_PRIVATE_KEY=
export VERSION=123456
export GO_PIPELINE_LABEL=latest
export CPU_REQUEST=10m
export MEMORY_REQUEST=15Mi
export CPU_LIMIT=200m
export MEMORY_LIMIT=512Mi
export GITHUB_APP_ID=1234
export GITHUB_APP_OAUTH_CLIENT_ID=ab3.myjk4935qfamx8sw
export GITHUB_APP_OAUTH_CLIENT_SECRET=***
export GITHUB_WEBHOOK_SECRET=***
export BITBUCKET_API_KEY=***
export BITBUCKET_APP_OAUTH_KEY=f7mFzNWdFbZ2m54aCb
export BITBUCKET_APP_OAUTH_SECRET=***
export ESTAFETTE_CI_API_KEY=***
export SLACK_APP_CLIENT_ID=1575687846.473375433834
export SLACK_APP_CLIENT_SECRET=***
export SLACK_APP_VERIFICATION_TOKEN=***
export SLACK_APP_OAUTH_ACCESS_TOKEN=***
export SECRET_DECRYPTION_KEY=***
export COCKROACH_DATABASE=estafette_ci_api
export COCKROACH_HOST=cockroachdb-public.estafette.svc.cluster.local
export COCKROACH_INSECURE=true
export COCKROACH_CERTS_DIR=
export COCKROACH_PORT=26257
export COCKROACH_USER=estafette_ci_api
export COCKROACH_PASSWORD=***
export ALLOW_CIDRS=allow 0.0.0.0/0;
export MIN_PODS=3
export MAX_PODS=10
export AUTOSCALE_CPU_TARGET_PERCENTAGE=80

cat kubernetes.yaml | envsubst | kubectl apply -f -
</code></pre></div><div class="col d-none d-xl-flex border-left toc sticky-top"><ul><li class=section-item><a class="section-item-link ancestor">Table of contents</a><ul><li class=page-item><a href=/getting-started/installation/#installing-estafette-ci title="Installing Estafette CI" class=page-item-link>Installing Estafette CI</a></ul></li></ul></div></div></div></div></div><nav class="footer nav justify-content-end bg-dark p-2"><a href=https://github.com/estafette/estafette-ci-central target=_blank class="nav-link text-light">Github</a></nav><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script></body></html>