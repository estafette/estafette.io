<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-464018-9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-464018-9');</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href="/apple-touch-icon.png?v=xQdjvJ8Lmw"><link rel=icon type=image/png sizes=32x32 href="/favicon-32x32.png?v=xQdjvJ8Lmw"><link rel=icon type=image/png sizes=16x16 href="/favicon-16x16.png?v=xQdjvJ8Lmw"><link rel=manifest href="/site.webmanifest?v=xQdjvJ8Lmw"><link rel=mask-icon href="/safari-pinned-tab.svg?v=xQdjvJ8Lmw" color=#28a745><link rel="shortcut icon" href="/favicon.ico?v=xQdjvJ8Lmw"><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><title>Github integration &ndash; Estafette CI/CD</title><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link rel=stylesheet href=https://estafette.io/sass/estafette.min.7f9f3ad31f44302446582e482cb18d648864a1d57e5e96611384029e40696adb.css integrity="sha256-f5860x9EMCRGWC5ILLGNZIhkodV+XpZhE4QCnkBpats="></head><body><div id=header-and-main><nav class="navbar navbar-dark bg-dark navbar-expand-md"><a href=/ class="navbar-brand text-white mr-3 router-link-exact-active active" target=_self><svg style="width:1.25em;overflow:visible;vertical-align:-2.5px" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="shipping-fast" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="m-0 ml-2 mr-2 h5 svg-inline--fa fa-shipping-fast fa-w-20"><path fill="currentcolor" d="M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H112C85.5.0 64 21.5 64 48v48H8c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h272c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H40c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H8c-4.4.0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4.0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H64v128c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8.0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5.0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm320 0c-26.5.0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"/></svg><em class=align-top>Estafette</em></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class=navbar-nav><a class="nav-item nav-link active" href=/getting-started/>Getting started</a><a class="nav-item nav-link" href=/usage/>Usage</a><a class="nav-item nav-link" href=/security/>Security</a><a class="nav-item nav-link" href=/design/>Design</a><a class="nav-item nav-link" href=/screenshots/>Screenshots</a></div></div></nav><div id=main><div class=container-fluid><div class="row mt-4 mb-4"><div class="col d-none d-md-flex border-right sidebar sticky-top"><ul><li class=section-item><a href=/getting-started/ class="section-item-link ancestor">Getting started</a><ul><li class=page-item><a href=/getting-started/installation/ class=page-item-link>Installation</a></li><li class=section-item><a href=/getting-started/github/ class="section-item-link ancestor active">Github integration</a></li><li class=page-item><a href=/getting-started/configuration/ class=page-item-link>Configuration</a></li></ul></li><li class=section-item><a href=/usage/ class=section-item-link>Usage</a></li><li class=section-item><a href=/security/ class=section-item-link>Security</a></li><li class=section-item><a href=/design/ class=section-item-link>Design</a></li><li class=section-item><a href=/screenshots/ class=section-item-link>Screenshots</a></li></ul></div><div class="col pl-5 pt-4 content-block"><div class=row><article class="col section-intro"><header><h1 class=mb-4>Github integration</h1></header><p>In order to receive Github events in your Estafette CI installation you need to create a Github App and Installation.</p><h2 id=register-a-github-app>Register a Github App</h2><p>Depending on whether you're using a <em>personal</em> Github account or an <em>organizational</em> account navigate to <code>https://github.com/settings/apps/new</code> for a personal account or <code>https://github.com/organizations/&lt;organization>/settings/apps/new</code> for your organization to register a Github App for Estafette CI.</p><p>Set the following values while registering the Github App:</p><ul><li><em>Github App Name</em> - Set to the hostname you're planning to host Estafette CI at.</li><li><em>Homepage Url</em> - The same hostname, but ensure it's prefixed by <code>https://</code>.</li><li><em>Webhook URL</em> - Has to be set to <code>https://&lt;webhook host>/api/integrations/github/events</code>. This separate hostname is open to the world for receiving webhooks, while your regular host is preferably behind an identity-aware access solutino.</li><li><em>Webhook secret</em> - Ensure it's set following these <a href=https://docs.github.com/en/developers/webhooks-and-events/webhooks/securing-your-webhooks>instructions</a>. Store it's value in a secure location like a password manager. You'll need it to configure Estafette.</li><li><em>Where can this GitHub App be installed?</em> - Only on this account</li></ul><h3 id=repository-permissions>Repository permissions</h3><p>To ensure the Github API can be used to retrieve necessary information for build & releases to work ensure the following permissions are set:</p><ul><li><em>Contents</em> - read-only</li><li><em>Metadata</em> - read-only</li></ul><h3 id=subscribe-to-events>Subscribe to events</h3><p>And to be informed about events to start builds and initiate other important actions subscribe to the following events:</p><ul><li>Repository</li><li>Push</li></ul><h2 id=update-the-github-app>Update the Github App</h2><p>After creating the Github App you want to go through some extra steps to ensure Estafette can communicate with the Github API.</p><ul><li><em>Generate a new client secret</em> - Copy the value and store it in a secure location like a password manager. You'll need it to configure Estafette.</li><li><em>Generate a private key</em> - Used to sign access token requests. Store the <em>pem</em> file in a secure location like a password manager. Again needed for configuring Estafette.</li></ul><h2 id=install-the-github-app>Install the Github App</h2><p>Go to the <em>Install App</em> tab and install it in the visible account (organization or personal). Select <em>All repositories</em> to make it possible for anyone creating a new reposity to be able to create a pipeline in the Estafette installation.</p><h2 id=configure-estafette>Configure Estafette</h2><p>Update the Helm installation with the following <code>estafette-ci.yaml</code> values file by running <code>helm upgrade --install estafette-ci estafette/estafette-ci -n estafette-ci --timeout 600s --values estafette.ci-yaml</code>:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>api:
  secret:
    files:
      <span style=color:#888;font-style:italic># the aes-256 key to encrypt/decrypt estafette secrets</span>
      secretDecryptionKey: &lt;random <span style=color:#3af>32</span> character string<span style=color:#5a2>&gt;
</span><span style=color:#5a2>
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>private-key.pem: |</span>
        -----BEGIN RSA PRIVATE KEY----<span style=color:#5a2>-
</span><span style=color:#5a2>       </span><span style=color:#5a2> </span><span style=color:#5a2>&lt;the github private key downloaded before&gt;</span>
        -----END RSA PRIVATE KEY----<span style=color:#5a2>-
</span><span style=color:#5a2>
</span><span style=color:#5a2> </span><span style=color:#5a2> </span><span style=color:#5a2>config:</span>
    files: <span style=color:#5a2>|
</span><span style=color:#5a2>     </span><span style=color:#5a2> </span><span style=color:#5a2>config.yaml: |</span>
        integrations:
          github:
            enable: <span style=color:#00f>true</span>
            appID: &lt;App ID<span style=color:#5a2>&gt;
</span><span style=color:#5a2>           </span><span style=color:#5a2> </span><span style=color:#5a2>clientID: &lt;Client ID&gt;</span>
            clientSecret: &lt;Client secret recorded before<span style=color:#5a2>&gt;
</span><span style=color:#5a2>           </span><span style=color:#5a2> </span><span style=color:#5a2>webhookSecret: &lt;Webhook secret recorded before&gt;</span>

        apiServer:
          baseURL: https://&lt;host&gt;
</code></pre></div></article></div><div class=row style=max-width:1024px></div></div><div class="col d-none d-xl-flex border-left toc sticky-top"><ul><li class=section-item><a class="section-item-link ancestor">Table of contents</a><ul><li class=page-item><a href=/getting-started/github/#register-a-github-app title="Register a Github App" class=page-item-link>Register a Github App</a><ul><li class=page-item><a href=/getting-started/github/#repository-permissions title="Repository permissions" class=page-item-link>Repository permissions</a><li class=page-item><a href=/getting-started/github/#subscribe-to-events title="Subscribe to events" class=page-item-link>Subscribe to events</a></ul><li class=page-item><a href=/getting-started/github/#update-the-github-app title="Update the Github App" class=page-item-link>Update the Github App</a><li class=page-item><a href=/getting-started/github/#install-the-github-app title="Install the Github App" class=page-item-link>Install the Github App</a><li class=page-item><a href=/getting-started/github/#configure-estafette title="Configure Estafette" class=page-item-link>Configure Estafette</a></ul></li></ul></div></div></div></div></div><nav class="footer nav justify-content-end bg-dark p-2"><a href=https://github.com/estafette/estafette-ci-central target=_blank class="nav-link text-light">Github</a></nav><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script></body></html>